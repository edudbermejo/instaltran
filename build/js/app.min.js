(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';

require('../features/credentials/login');

require('../features/inside');

angular.module('entry', ['credentials.login', 'inside']);

},{"../features/credentials/login":4,"../features/inside":8}],2:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

exports.default = function ($stateProvider, $urlRouterProvider) {
    'ngInject';

    $urlRouterProvider.otherwise('/login');

    $stateProvider.state('login', {
        url: '/login',
        templateUrl: 'src/features/credentials/login/template.html',
        controller: 'LoginController as lc'
    });
};

},{}],3:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

exports.default = function ($usersManager, $state, $externalCalls) {
    'ngInject';

    var lc = this;

    lc.tryLogin = function () {

        if (!lc.user) {
            Materialize.toast('No se ha introducido usuario', 2000);
        } else {
            if (!lc.pass) {
                Materialize.toast('El campo contraseña es obligatorio', 2000);
            } else {

                $externalCalls.getUserByUsername(lc.user).then(logAndJump).catch(function () {
                    Materialize.toast('El usuario introducido no existe', 2000);
                });
            }
        }

        function logAndJump(user) {
            if (lc.pass === user.password) {
                $usersManager.setLoggedUser(user);
                $state.go('inside.timeline');
            } else {
                Materialize.toast('La contraseña no es correcta', 2000);
            }
        }
    };
};

},{}],4:[function(require,module,exports){
'use strict';

require('../../transversal/usersManager');

require('../../transversal/externalCalls');

var _config = require('./config');

var _config2 = _interopRequireDefault(_config);

var _controller = require('./controller');

var _controller2 = _interopRequireDefault(_controller);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

angular.module('credentials.login', ['ui.router', 'transversal.usersManager', 'transversal.externalCalls']).config(_config2.default).controller('LoginController', _controller2.default);

},{"../../transversal/externalCalls":15,"../../transversal/usersManager":17,"./config":2,"./controller":3}],5:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

exports.default = function () {
    return {
        bindings: {
            photo: '<'
        },
        controller: function controller() {},
        templateUrl: 'src/features/inside/components/photoInList/template.html'
    };
};

},{}],6:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

exports.default = function ($stateProvider) {
    'ngInject';

    $stateProvider.state('inside', {
        url: '/inside',
        abstract: true,
        templateUrl: 'src/features/inside/template.html',
        controller: 'InsideController as ic'
    });
};

},{}],7:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
    value: true
});

exports.default = function ($state) {
    'ngInject';

    var ic = this;
    var _darkBackground = "col s6 center-align green darken-3";
    var _lightBackground = "col s6 center-align light-green accent-1";
    var _darkIcon = "material-icons medium light-green-text text-darken-4";
    var _lightIcon = "material-icons medium light-green-text text-lighten-4";

    ic.classTimelineBackground = _darkBackground;
    ic.classTimelineIcon = _lightIcon;
    ic.classSharePhotoBackground = _lightBackground;
    ic.classSharePhotoIcon = _darkIcon;

    ic.goTimeline = function () {
        ic.classTimelineBackground = _darkBackground;
        ic.classTimelineIcon = _lightIcon;
        ic.classSharePhotoBackground = _lightBackground;
        ic.classSharePhotoIcon = _darkIcon;
        $state.go('^.timeline');
    };

    ic.goSharePhoto = function () {
        ic.classTimelineBackground = _lightBackground;
        ic.classTimelineIcon = _darkIcon;
        ic.classSharePhotoBackground = _darkBackground;
        ic.classSharePhotoIcon = _lightIcon;
        $state.go('^.sharephoto');
    };
};

},{}],8:[function(require,module,exports){
'use strict';

var _config = require('./config');

var _config2 = _interopRequireDefault(_config);

var _controller = require('./controller');

var _controller2 = _interopRequireDefault(_controller);

require('./timeline');

require('./share-photo');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

angular.module('inside', ['ui.router', 'inside.timeline', 'inside.sharePhoto']).config(_config2.default).controller('InsideController', _controller2.default);

},{"./config":6,"./controller":7,"./share-photo":11,"./timeline":14}],9:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

exports.default = function ($stateProvider) {
    'ngInject';

    $stateProvider.state('inside.sharephoto', {
        url: '/sharephoto',
        templateUrl: '/src/features/inside/share-photo/template.html',
        controller: 'SharePhotoController as spc'
    });
};

},{}],10:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

exports.default = function ($externalCalls, $state) {

    var spc = this;

    spc.upPhoto = function () {

        if (!spc.imgUrl) {
            Materialize.toast('No se ha introducido una ruta', 2000);
        } else {
            $externalCalls.postPhoto(spc.imgUrl, spc.title).then(function () {
                $state.go('inside.timeline');
            }).catch(function () {
                Materialize.toast('Ocurrio un problema. Intentalo mas tarde', 2000);
            });
        }
    };
};

},{}],11:[function(require,module,exports){
'use strict';

require('../../transversal/externalCalls');

var _config = require('./config');

var _config2 = _interopRequireDefault(_config);

var _controller = require('./controller');

var _controller2 = _interopRequireDefault(_controller);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

angular.module('inside.sharePhoto', ['transversal.externalCalls']).config(_config2.default).controller('SharePhotoController', _controller2.default);

},{"../../transversal/externalCalls":15,"./config":9,"./controller":10}],12:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

exports.default = function ($stateProvider) {
    'ngInject';

    $stateProvider.state('inside.timeline', {
        url: '/timeline',
        templateUrl: '/src/features/inside/timeline/template.html',
        controller: 'TimelineController as tc'
    });
};

},{}],13:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

exports.default = function ($externalCalls) {
    'ngInject';

    var tc = this;

    var _page = 1;

    /*tc.photos = [{
        user_id : 'Gastly',
        image : 'img/prueba.png',
        likes : 123,
        title : 'Buh!'
    }, {
        user_id : 'Haunter',
        image : 'img/haunter.png',
        likes : 321,
        title : 'Buh++!'
    }];*/

    tc.photos = $externalCalls.getPhotosTimeline(_page);
    console.log(tc.photos);

    tc.morePhotos = function () {
        _page++, tc.photos.push($externalCalls.getPhotos(_page));
    };
};

},{}],14:[function(require,module,exports){
'use strict';

var _config = require('./config');

var _config2 = _interopRequireDefault(_config);

var _controller = require('./controller');

var _controller2 = _interopRequireDefault(_controller);

var _photoInList = require('../components/photoInList');

var _photoInList2 = _interopRequireDefault(_photoInList);

require('../../transversal/externalCalls');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

angular.module('inside.timeline', ['ui.router', 'transversal.externalCalls']).config(_config2.default).controller('TimelineController', _controller2.default).component('instTimePhoto', (0, _photoInList2.default)());

},{"../../transversal/externalCalls":15,"../components/photoInList":5,"./config":12,"./controller":13}],15:[function(require,module,exports){
'use strict';

var _service = require('./service');

var _service2 = _interopRequireDefault(_service);

require('../usersManager');

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

angular.module('transversal.externalCalls', ['transversal.usersManager']).service('$externalCalls', _service2.default);

},{"../usersManager":17,"./service":16}],16:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

exports.default = function ($usersManager, $http, $q) {
    'ngInject';

    var _url = 'http://localhost:2222';

    // Recupera fotos con paginacion. Se pasan los followed para hacer join.
    this.getPhotosTimeline = function (page) {
        var _qu = $q.defer();

        var _user = $usersManager.getLoggedUser();

        return $http({
            url: _url + '/photos',
            method: 'GET',
            params: { page: page,
                userid: _user._id }
        }).then(backPhotosOK).catch(backPhotosWrong);

        function backPhotosOK(response) {
            if (response.data) {
                _qu.resolve(response.data);
            } else {
                _qu.reject('Nothing found');
            }
        };

        function backPhotosWrong(error) {
            _qu.reject('Error');
        }

        return _qu.promise;
    };

    // Recupera un usuario haciendo uso de su id (en tabla de mongo)
    this.getUserById = function (id) {

        var _qu = $q.defer();

        return $http({
            url: _url + '/users/' + id,
            method: 'GET'
        }).then(backUserOK).catch(backUserWrong);

        function backUserOK(response) {
            if (response.data) {
                _qu.resolve(response.data);
            } else {
                _qu.reject('Nothing found');
            }
        };

        function backUserWrong(error) {
            _qu.reject('Error');
        }

        return _qu.promise;
    };

    // Recupera un usuario haciendo uso de su username
    this.getUserByUsername = function (username) {

        var _qu = $q.defer();

        $http({
            url: _url + '/users',
            params: {
                username: username,
                strict: "s"
            },
            method: 'GET'
        }).then(backUserOK).catch(backUserWrong);

        function backUserOK(response) {
            if (response.data) {
                _qu.resolve(response.data);
            } else {
                _qu.reject('Nothing found');
            }
        };

        function backUserWrong(error) {
            _qu.reject('Error');
        }

        return _qu.promise;
    };

    this.postPhoto = function (url, title) {

        var _qu = $q.defer();

        var _user = $usersManager.getLoggedUser();

        $http({
            url: _url + '/photos',
            data: {
                image: url,
                username: _user.username,
                user_id: _user._id,
                title: title
            },
            method: 'POST'
        }).then(upPhotoOK).catch(upPhotoWrong);

        function upPhotoOK(response) {
            _qu.resolve(response.data);
        };

        function upPhotoWrong(error) {
            _qu.reject('Error');
        }

        return _qu.promise;
    };
};

},{}],17:[function(require,module,exports){
'use strict';

var _service = require('./service');

var _service2 = _interopRequireDefault(_service);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

angular.module('transversal.usersManager', []).service('$usersManager', _service2.default);

},{"./service":18}],18:[function(require,module,exports){
'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

exports.default = function () {
    'ngInject';

    var _logged;

    this.setLoggedUser = function (user) {
        _logged = user;
    };

    this.getLoggedUser = function () {
        return _logged;
    };

    this.loggout = function () {
        _logged = null;
    };
};

},{}]},{},[1])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvaW5kZXguanMiLCJzcmMvZmVhdHVyZXMvY3JlZGVudGlhbHMvbG9naW4vY29uZmlnLmpzIiwic3JjL2ZlYXR1cmVzL2NyZWRlbnRpYWxzL2xvZ2luL2NvbnRyb2xsZXIuanMiLCJzcmMvZmVhdHVyZXMvY3JlZGVudGlhbHMvbG9naW4vaW5kZXguanMiLCJzcmMvZmVhdHVyZXMvaW5zaWRlL2NvbXBvbmVudHMvcGhvdG9Jbkxpc3QvaW5kZXguanMiLCJzcmMvZmVhdHVyZXMvaW5zaWRlL2NvbmZpZy5qcyIsInNyYy9mZWF0dXJlcy9pbnNpZGUvY29udHJvbGxlci5qcyIsInNyYy9mZWF0dXJlcy9pbnNpZGUvaW5kZXguanMiLCJzcmMvZmVhdHVyZXMvaW5zaWRlL3NoYXJlLXBob3RvL2NvbmZpZy5qcyIsInNyYy9mZWF0dXJlcy9pbnNpZGUvc2hhcmUtcGhvdG8vY29udHJvbGxlci5qcyIsInNyYy9mZWF0dXJlcy9pbnNpZGUvc2hhcmUtcGhvdG8vaW5kZXguanMiLCJzcmMvZmVhdHVyZXMvaW5zaWRlL3RpbWVsaW5lL2NvbmZpZy5qcyIsInNyYy9mZWF0dXJlcy9pbnNpZGUvdGltZWxpbmUvY29udHJvbGxlci5qcyIsInNyYy9mZWF0dXJlcy9pbnNpZGUvdGltZWxpbmUvaW5kZXguanMiLCJzcmMvZmVhdHVyZXMvdHJhbnN2ZXJzYWwvZXh0ZXJuYWxDYWxscy9pbmRleC5qcyIsInNyYy9mZWF0dXJlcy90cmFuc3ZlcnNhbC9leHRlcm5hbENhbGxzL3NlcnZpY2UuanMiLCJzcmMvZmVhdHVyZXMvdHJhbnN2ZXJzYWwvdXNlcnNNYW5hZ2VyL2luZGV4LmpzIiwic3JjL2ZlYXR1cmVzL3RyYW5zdmVyc2FsL3VzZXJzTWFuYWdlci9zZXJ2aWNlLmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBOzs7Ozs7O0FDR0EsUUFDSyxNQURM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QVcsTUFBTSxRQUFOO0FBQ1gseUJBQVUsTUFBTSxHQUFOO0FBQ1YsdUJBQVEsS0FBUjthQUpKO0FBTUEsb0JBQVMsTUFBVDtTQVJKLEVBU0csSUFUSCxDQVNRLFNBVFIsRUFVQyxLQVZELENBVU8sWUFWUCxFQU5pQzs7QUFrQmpDLGlCQUFTLFNBQVQsQ0FBbUIsUUFBbkIsRUFBNkI7QUFDekIsZ0JBQUksT0FBSixDQUFZLFNBQVMsSUFBVCxDQUFaLENBRHlCO1NBQTdCLENBbEJpQzs7QUFzQmpDLGlCQUFTLFlBQVQsQ0FBc0IsS0FBdEIsRUFBNkI7QUFDekIsZ0JBQUksTUFBSixDQUFXLE9BQVgsRUFEeUI7U0FBN0I7O0FBSUEsZUFBTyxJQUFJLE9BQUosQ0ExQjBCO0tBQXBCLENBMUY4QjtDQUFwQzs7Ozs7Ozs7Ozs7QUNFZixRQUNLLE1BREwsQ0FDWSwwQkFEWixFQUN3QyxFQUR4QyxFQUVLLE9BRkwsQ0FFYSxlQUZiOzs7Ozs7Ozs7a0JDRmUsWUFBWTtBQUN2QixlQUR1Qjs7QUFFdkIsUUFBSSxPQUFKLENBRnVCOztBQUl2QixTQUFLLGFBQUwsR0FBcUIsVUFBUyxJQUFULEVBQWU7QUFDaEMsa0JBQVUsSUFBVixDQURnQztLQUFmLENBSkU7O0FBUXZCLFNBQUssYUFBTCxHQUFxQixZQUFXO0FBQzVCLGVBQU8sT0FBUCxDQUQ0QjtLQUFYLENBUkU7O0FBWXZCLFNBQUssT0FBTCxHQUFlLFlBQVc7QUFDdEIsa0JBQVUsSUFBVixDQURzQjtLQUFYLENBWlE7Q0FBWiIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCJpbXBvcnQgJy4uL2ZlYXR1cmVzL2NyZWRlbnRpYWxzL2xvZ2luJztcbmltcG9ydCAnLi4vZmVhdHVyZXMvaW5zaWRlJ1xuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgnZW50cnknLCBbXG4gICAgICAgICdjcmVkZW50aWFscy5sb2dpbicsXG4gICAgICAgICdpbnNpZGUnXG4gICAgXSk7IiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcbiAgICAnbmdJbmplY3QnO1xuICAgICR1cmxSb3V0ZXJQcm92aWRlci5vdGhlcndpc2UoJy9sb2dpbicpO1xuXG4gICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoJ2xvZ2luJywge1xuICAgICAgICB1cmw6ICcvbG9naW4nLFxuICAgICAgICB0ZW1wbGF0ZVVybDogJ3NyYy9mZWF0dXJlcy9jcmVkZW50aWFscy9sb2dpbi90ZW1wbGF0ZS5odG1sJyxcbiAgICAgICAgY29udHJvbGxlcjogJ0xvZ2luQ29udHJvbGxlciBhcyBsYydcbiAgICB9KVxufSIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uICgkdXNlcnNNYW5hZ2VyLCAkc3RhdGUsICRleHRlcm5hbENhbGxzKSB7XG4gICAgJ25nSW5qZWN0JztcbiAgICB2YXIgbGMgPSB0aGlzO1xuXG4gICAgbGMudHJ5TG9naW4gPSBmdW5jdGlvbiAoKSB7XG5cbiAgICAgICAgaWYgKCFsYy51c2VyKSB7XG4gICAgICAgICAgICBNYXRlcmlhbGl6ZS50b2FzdCgnTm8gc2UgaGEgaW50cm9kdWNpZG8gdXN1YXJpbycsIDIwMDApO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgaWYgKCFsYy5wYXNzKSB7XG4gICAgICAgICAgICAgICAgTWF0ZXJpYWxpemUudG9hc3QoJ0VsIGNhbXBvIGNvbnRyYXNlw7FhIGVzIG9ibGlnYXRvcmlvJywgMjAwMCk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgJGV4dGVybmFsQ2FsbHMuZ2V0VXNlckJ5VXNlcm5hbWUobGMudXNlcilcbiAgICAgICAgICAgICAgICAgICAgLnRoZW4obG9nQW5kSnVtcClcbiAgICAgICAgICAgICAgICAgICAgLmNhdGNoKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIE1hdGVyaWFsaXplLnRvYXN0KCdFbCB1c3VhcmlvIGludHJvZHVjaWRvIG5vIGV4aXN0ZScsIDIwMDApO1xuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGxvZ0FuZEp1bXAodXNlcikge1xuICAgICAgICAgICAgaWYgKGxjLnBhc3MgPT09IHVzZXIucGFzc3dvcmQpIHtcbiAgICAgICAgICAgICAgICAkdXNlcnNNYW5hZ2VyLnNldExvZ2dlZFVzZXIodXNlcik7XG4gICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdpbnNpZGUudGltZWxpbmUnKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgTWF0ZXJpYWxpemUudG9hc3QoJ0xhIGNvbnRyYXNlw7FhIG5vIGVzIGNvcnJlY3RhJywgMjAwMCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9O1xufSIsImltcG9ydCAnLi4vLi4vdHJhbnN2ZXJzYWwvdXNlcnNNYW5hZ2VyJztcbmltcG9ydCAnLi4vLi4vdHJhbnN2ZXJzYWwvZXh0ZXJuYWxDYWxscyc7XG5pbXBvcnQgY29uZmlnIGZyb20gJy4vY29uZmlnJztcbmltcG9ydCBjb250cm9sbGVyIGZyb20gJy4vY29udHJvbGxlcic7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdjcmVkZW50aWFscy5sb2dpbicsIFtcbiAgICAgICAgJ3VpLnJvdXRlcicsICAgICAgICBcbiAgICAgICAgJ3RyYW5zdmVyc2FsLnVzZXJzTWFuYWdlcicsXG4gICAgICAgICd0cmFuc3ZlcnNhbC5leHRlcm5hbENhbGxzJ1xuICAgIF0pXG4gICAgLmNvbmZpZyhjb25maWcpXG4gICAgLmNvbnRyb2xsZXIoJ0xvZ2luQ29udHJvbGxlcicsIGNvbnRyb2xsZXIpOyIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uICgpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBiaW5kaW5nczoge1xuICAgICAgICAgICAgcGhvdG86ICc8J1xuICAgICAgICB9LFxuICAgICAgICBjb250cm9sbGVyOiBmdW5jdGlvbiAoKSB7fSxcbiAgICAgICAgdGVtcGxhdGVVcmw6ICdzcmMvZmVhdHVyZXMvaW5zaWRlL2NvbXBvbmVudHMvcGhvdG9Jbkxpc3QvdGVtcGxhdGUuaHRtbCdcbiAgICB9XG59IiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgJ25nSW5qZWN0JztcbiAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnaW5zaWRlJywge1xuICAgICAgICB1cmw6ICcvaW5zaWRlJyxcbiAgICAgICAgYWJzdHJhY3QgOiB0cnVlLFxuICAgICAgICB0ZW1wbGF0ZVVybCA6ICdzcmMvZmVhdHVyZXMvaW5zaWRlL3RlbXBsYXRlLmh0bWwnLFxuICAgICAgICBjb250cm9sbGVyIDogJ0luc2lkZUNvbnRyb2xsZXIgYXMgaWMnXG4gICAgfSlcbiAgICBcbn0iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiAoJHN0YXRlKSB7XG4gICAgJ25nSW5qZWN0JztcbiAgICB2YXIgaWMgPSB0aGlzO1xuICAgIHZhciBfZGFya0JhY2tncm91bmQgPSBcImNvbCBzNiBjZW50ZXItYWxpZ24gZ3JlZW4gZGFya2VuLTNcIjtcbiAgICB2YXIgX2xpZ2h0QmFja2dyb3VuZCA9IFwiY29sIHM2IGNlbnRlci1hbGlnbiBsaWdodC1ncmVlbiBhY2NlbnQtMVwiO1xuICAgIHZhciBfZGFya0ljb24gPSBcIm1hdGVyaWFsLWljb25zIG1lZGl1bSBsaWdodC1ncmVlbi10ZXh0IHRleHQtZGFya2VuLTRcIjtcbiAgICB2YXIgX2xpZ2h0SWNvbiA9IFwibWF0ZXJpYWwtaWNvbnMgbWVkaXVtIGxpZ2h0LWdyZWVuLXRleHQgdGV4dC1saWdodGVuLTRcIlxuXG4gICAgaWMuY2xhc3NUaW1lbGluZUJhY2tncm91bmQgPSBfZGFya0JhY2tncm91bmQ7XG4gICAgaWMuY2xhc3NUaW1lbGluZUljb24gPSBfbGlnaHRJY29uO1xuICAgIGljLmNsYXNzU2hhcmVQaG90b0JhY2tncm91bmQgPSBfbGlnaHRCYWNrZ3JvdW5kO1xuICAgIGljLmNsYXNzU2hhcmVQaG90b0ljb24gPSBfZGFya0ljb247XG5cbiAgICBpYy5nb1RpbWVsaW5lID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBpYy5jbGFzc1RpbWVsaW5lQmFja2dyb3VuZCA9IF9kYXJrQmFja2dyb3VuZDtcbiAgICAgICAgaWMuY2xhc3NUaW1lbGluZUljb24gPSBfbGlnaHRJY29uO1xuICAgICAgICBpYy5jbGFzc1NoYXJlUGhvdG9CYWNrZ3JvdW5kID0gX2xpZ2h0QmFja2dyb3VuZDtcbiAgICAgICAgaWMuY2xhc3NTaGFyZVBob3RvSWNvbiA9IF9kYXJrSWNvbjtcbiAgICAgICAgJHN0YXRlLmdvKCdeLnRpbWVsaW5lJyk7XG4gICAgfTtcblxuICAgIGljLmdvU2hhcmVQaG90byA9IGZ1bmN0aW9uICgpIHtcbiAgICAgICAgaWMuY2xhc3NUaW1lbGluZUJhY2tncm91bmQgPSBfbGlnaHRCYWNrZ3JvdW5kO1xuICAgICAgICBpYy5jbGFzc1RpbWVsaW5lSWNvbiA9IF9kYXJrSWNvbjtcbiAgICAgICAgaWMuY2xhc3NTaGFyZVBob3RvQmFja2dyb3VuZCA9IF9kYXJrQmFja2dyb3VuZDtcbiAgICAgICAgaWMuY2xhc3NTaGFyZVBob3RvSWNvbiA9IF9saWdodEljb247XG4gICAgICAgICRzdGF0ZS5nbygnXi5zaGFyZXBob3RvJyk7XG4gICAgfTtcbn0iLCJpbXBvcnQgY29uZmlnIGZyb20gJy4vY29uZmlnJztcbmltcG9ydCBjb250cm9sbGVyIGZyb20gJy4vY29udHJvbGxlcic7XG5pbXBvcnQgJy4vdGltZWxpbmUnO1xuaW1wb3J0ICcuL3NoYXJlLXBob3RvJztcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ2luc2lkZScsIFtcbiAgICAgICAgJ3VpLnJvdXRlcicsXG4gICAgICAgICdpbnNpZGUudGltZWxpbmUnLFxuICAgICAgICAnaW5zaWRlLnNoYXJlUGhvdG8nICAgICAgICBcbiAgICBdKVxuICAgIC5jb25maWcoY29uZmlnKVxuICAgIC5jb250cm9sbGVyKCdJbnNpZGVDb250cm9sbGVyJywgY29udHJvbGxlcik7IiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgJ25nSW5qZWN0JztcbiAgICBcbiAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnaW5zaWRlLnNoYXJlcGhvdG8nLCB7XG4gICAgICAgIHVybDogJy9zaGFyZXBob3RvJyxcbiAgICAgICAgdGVtcGxhdGVVcmwgOiAnL3NyYy9mZWF0dXJlcy9pbnNpZGUvc2hhcmUtcGhvdG8vdGVtcGxhdGUuaHRtbCcsXG4gICAgICAgIGNvbnRyb2xsZXIgOiAnU2hhcmVQaG90b0NvbnRyb2xsZXIgYXMgc3BjJ1xuICAgIH0pO1xufSIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uICgkZXh0ZXJuYWxDYWxscywgJHN0YXRlKSB7XG5cbiAgICB2YXIgc3BjID0gdGhpcztcblxuICAgIHNwYy51cFBob3RvID0gZnVuY3Rpb24gKCkge1xuXG4gICAgICAgIGlmICghc3BjLmltZ1VybCkge1xuICAgICAgICAgICAgTWF0ZXJpYWxpemUudG9hc3QoJ05vIHNlIGhhIGludHJvZHVjaWRvIHVuYSBydXRhJywgMjAwMCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAkZXh0ZXJuYWxDYWxscy5wb3N0UGhvdG8oc3BjLmltZ1VybCwgc3BjLnRpdGxlKVxuICAgICAgICAgICAgICAgIC50aGVuKGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdpbnNpZGUudGltZWxpbmUnKTtcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIC5jYXRjaChmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgICAgIE1hdGVyaWFsaXplLnRvYXN0KCdPY3VycmlvIHVuIHByb2JsZW1hLiBJbnRlbnRhbG8gbWFzIHRhcmRlJywgMjAwMCk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cbiAgICB9XG5cbn0iLCJpbXBvcnQgJy4uLy4uL3RyYW5zdmVyc2FsL2V4dGVybmFsQ2FsbHMnO1xuaW1wb3J0IGNvbmZpZyBmcm9tICcuL2NvbmZpZyc7XG5pbXBvcnQgY29udHJvbGxlciBmcm9tICcuL2NvbnRyb2xsZXInO1xuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgnaW5zaWRlLnNoYXJlUGhvdG8nLCBbXG4gICAgICAgICd0cmFuc3ZlcnNhbC5leHRlcm5hbENhbGxzJ1xuICAgIF0pXG4gICAgLmNvbmZpZyhjb25maWcpXG4gICAgLmNvbnRyb2xsZXIoJ1NoYXJlUGhvdG9Db250cm9sbGVyJywgY29udHJvbGxlcik7IiwiZXhwb3J0IGRlZmF1bHQgZnVuY3Rpb24gKCRzdGF0ZVByb3ZpZGVyKSB7XG4gICAgJ25nSW5qZWN0JztcbiAgICAkc3RhdGVQcm92aWRlci5zdGF0ZSgnaW5zaWRlLnRpbWVsaW5lJywge1xuICAgICAgICB1cmw6ICcvdGltZWxpbmUnLFxuICAgICAgICB0ZW1wbGF0ZVVybCA6ICcvc3JjL2ZlYXR1cmVzL2luc2lkZS90aW1lbGluZS90ZW1wbGF0ZS5odG1sJyxcbiAgICAgICAgY29udHJvbGxlciA6ICdUaW1lbGluZUNvbnRyb2xsZXIgYXMgdGMnXG4gICAgfSlcbiAgICBcbn0iLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiAoJGV4dGVybmFsQ2FsbHMpIHtcbiAgICAnbmdJbmplY3QnO1xuICAgIHZhciB0YyA9IHRoaXM7XG4gICAgXG4gICAgdmFyIF9wYWdlID0gMTtcbiAgICBcbiAgICAvKnRjLnBob3RvcyA9IFt7XG4gICAgICAgIHVzZXJfaWQgOiAnR2FzdGx5JyxcbiAgICAgICAgaW1hZ2UgOiAnaW1nL3BydWViYS5wbmcnLFxuICAgICAgICBsaWtlcyA6IDEyMyxcbiAgICAgICAgdGl0bGUgOiAnQnVoISdcbiAgICB9LCB7XG4gICAgICAgIHVzZXJfaWQgOiAnSGF1bnRlcicsXG4gICAgICAgIGltYWdlIDogJ2ltZy9oYXVudGVyLnBuZycsXG4gICAgICAgIGxpa2VzIDogMzIxLFxuICAgICAgICB0aXRsZSA6ICdCdWgrKyEnXG4gICAgfV07Ki9cbiAgICBcbiAgICB0Yy5waG90b3MgPSAkZXh0ZXJuYWxDYWxscy5nZXRQaG90b3NUaW1lbGluZShfcGFnZSk7XG4gICAgY29uc29sZS5sb2codGMucGhvdG9zKTtcbiAgICBcbiAgICB0Yy5tb3JlUGhvdG9zID0gZnVuY3Rpb24gKCkge1xuICAgICAgICBfcGFnZSsrLFxuICAgICAgICB0Yy5waG90b3MucHVzaCgkZXh0ZXJuYWxDYWxscy5nZXRQaG90b3MoX3BhZ2UpKTtcbiAgICB9XG59IiwiaW1wb3J0IGNvbmZpZyBmcm9tICcuL2NvbmZpZyc7XG5pbXBvcnQgY29udHJvbGxlciBmcm9tICcuL2NvbnRyb2xsZXInO1xuaW1wb3J0IGNvbXBvbmVudCBmcm9tICcuLi9jb21wb25lbnRzL3Bob3RvSW5MaXN0JztcbmltcG9ydCAnLi4vLi4vdHJhbnN2ZXJzYWwvZXh0ZXJuYWxDYWxscyc7XG5cbmFuZ3VsYXJcbiAgICAubW9kdWxlKCdpbnNpZGUudGltZWxpbmUnLCBbXG4gICAgICAgICd1aS5yb3V0ZXInLFxuICAgICAgICAndHJhbnN2ZXJzYWwuZXh0ZXJuYWxDYWxscydcbiAgICBdKVxuICAgIC5jb25maWcoY29uZmlnKVxuICAgIC5jb250cm9sbGVyKCdUaW1lbGluZUNvbnRyb2xsZXInLCBjb250cm9sbGVyKVxuICAgIC5jb21wb25lbnQoJ2luc3RUaW1lUGhvdG8nLCBjb21wb25lbnQoKSk7IiwiaW1wb3J0IHNlcnZpY2UgZnJvbSAnLi9zZXJ2aWNlJztcbmltcG9ydCAnLi4vdXNlcnNNYW5hZ2VyJztcblxuYW5ndWxhclxuICAgIC5tb2R1bGUoJ3RyYW5zdmVyc2FsLmV4dGVybmFsQ2FsbHMnLCBbXG4gICAgICAgICd0cmFuc3ZlcnNhbC51c2Vyc01hbmFnZXInXG4gICAgXSlcbiAgICAuc2VydmljZSgnJGV4dGVybmFsQ2FsbHMnLCBzZXJ2aWNlKTsiLCJleHBvcnQgZGVmYXVsdCBmdW5jdGlvbiAoJHVzZXJzTWFuYWdlciwgJGh0dHAsICRxKSB7XG4gICAgJ25nSW5qZWN0JztcbiAgICBcbiAgICB2YXIgX3VybCA9ICdodHRwOi8vbG9jYWxob3N0OjIyMjInO1xuICAgIFxuICAgIC8vIFJlY3VwZXJhIGZvdG9zIGNvbiBwYWdpbmFjaW9uLiBTZSBwYXNhbiBsb3MgZm9sbG93ZWQgcGFyYSBoYWNlciBqb2luLlxuICAgIHRoaXMuZ2V0UGhvdG9zVGltZWxpbmUgPSBmdW5jdGlvbihwYWdlKSB7XG4gICAgICAgIHZhciBfcXUgPSAkcS5kZWZlcigpO1xuICAgICAgICBcbiAgICAgICAgdmFyIF91c2VyID0gJHVzZXJzTWFuYWdlci5nZXRMb2dnZWRVc2VyKCk7XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gJGh0dHAoe1xuICAgICAgICAgICAgdXJsIDogX3VybCArICcvcGhvdG9zJyxcbiAgICAgICAgICAgIG1ldGhvZCA6ICdHRVQnLFxuICAgICAgICAgICAgcGFyYW1zIDogeyBwYWdlIDogcGFnZSxcbiAgICAgICAgICAgICAgICB1c2VyaWQgOiBfdXNlci5faWR9XG4gICAgICAgIH0pLnRoZW4oYmFja1Bob3Rvc09LKVxuICAgICAgICAuY2F0Y2goYmFja1Bob3Rvc1dyb25nKTtcbiAgICAgICAgXG4gICAgICAgIGZ1bmN0aW9uIGJhY2tQaG90b3NPSyhyZXNwb25zZSkge1xuICAgICAgICAgICAgaWYocmVzcG9uc2UuZGF0YSl7XG4gICAgICAgICAgICAgICAgX3F1LnJlc29sdmUocmVzcG9uc2UuZGF0YSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIF9xdS5yZWplY3QoJ05vdGhpbmcgZm91bmQnKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfTtcbiAgICAgICAgXG4gICAgICAgIGZ1bmN0aW9uIGJhY2tQaG90b3NXcm9uZyhlcnJvcikge1xuICAgICAgICAgICAgX3F1LnJlamVjdCgnRXJyb3InKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIF9xdS5wcm9taXNlOyAgICAgICAgXG4gICAgfTtcbiAgICBcbiAgICAvLyBSZWN1cGVyYSB1biB1c3VhcmlvIGhhY2llbmRvIHVzbyBkZSBzdSBpZCAoZW4gdGFibGEgZGUgbW9uZ28pXG4gICAgdGhpcy5nZXRVc2VyQnlJZCA9IGZ1bmN0aW9uKGlkKXtcbiAgICAgICAgXG4gICAgICAgIHZhciBfcXUgPSAkcS5kZWZlcigpO1xuICAgICAgICBcbiAgICAgICAgcmV0dXJuICRodHRwKHtcbiAgICAgICAgICAgIHVybCA6IF91cmwgKyAnL3VzZXJzLycrIGlkLFxuICAgICAgICAgICAgbWV0aG9kIDogJ0dFVCdcbiAgICAgICAgfSkudGhlbihiYWNrVXNlck9LKVxuICAgICAgICAuY2F0Y2goYmFja1VzZXJXcm9uZyk7XG4gICAgICAgIFxuICAgICAgICBmdW5jdGlvbiBiYWNrVXNlck9LKHJlc3BvbnNlKSB7XG4gICAgICAgICAgICBpZihyZXNwb25zZS5kYXRhKXtcbiAgICAgICAgICAgICAgICBfcXUucmVzb2x2ZShyZXNwb25zZS5kYXRhKTtcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgX3F1LnJlamVjdCgnTm90aGluZyBmb3VuZCcpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgZnVuY3Rpb24gYmFja1VzZXJXcm9uZyhlcnJvcikge1xuICAgICAgICAgICAgX3F1LnJlamVjdCgnRXJyb3InKTtcbiAgICAgICAgfVxuICAgICAgICBcbiAgICAgICAgcmV0dXJuIF9xdS5wcm9taXNlO1xuICAgIH07XG4gICAgXG4gICAgLy8gUmVjdXBlcmEgdW4gdXN1YXJpbyBoYWNpZW5kbyB1c28gZGUgc3UgdXNlcm5hbWUgXG4gICAgdGhpcy5nZXRVc2VyQnlVc2VybmFtZSA9IGZ1bmN0aW9uKHVzZXJuYW1lKXtcbiAgICAgICAgXG4gICAgICAgIHZhciBfcXUgPSAkcS5kZWZlcigpO1xuICAgICAgICBcbiAgICAgICAgJGh0dHAoe1xuICAgICAgICAgICAgdXJsIDogX3VybCArICcvdXNlcnMnLFxuICAgICAgICAgICAgcGFyYW1zIDoge1xuICAgICAgICAgICAgICAgIHVzZXJuYW1lIDogdXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgc3RyaWN0IDogXCJzXCJcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBtZXRob2QgOiAnR0VUJ1xuICAgICAgICB9KS50aGVuKGJhY2tVc2VyT0spXG4gICAgICAgIC5jYXRjaChiYWNrVXNlcldyb25nKTtcbiAgICAgICAgXG4gICAgICAgIGZ1bmN0aW9uIGJhY2tVc2VyT0socmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGlmKHJlc3BvbnNlLmRhdGEpe1xuICAgICAgICAgICAgICAgIF9xdS5yZXNvbHZlKHJlc3BvbnNlLmRhdGEpO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBfcXUucmVqZWN0KCdOb3RoaW5nIGZvdW5kJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIFxuICAgICAgICBmdW5jdGlvbiBiYWNrVXNlcldyb25nKGVycm9yKSB7XG4gICAgICAgICAgICBfcXUucmVqZWN0KCdFcnJvcicpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gX3F1LnByb21pc2U7XG4gICAgfTtcbiAgICBcbiAgICB0aGlzLnBvc3RQaG90byA9IGZ1bmN0aW9uKHVybCwgdGl0bGUpe1xuICAgICAgICBcbiAgICAgICAgdmFyIF9xdSA9ICRxLmRlZmVyKCk7XG4gICAgICAgIFxuICAgICAgICB2YXIgX3VzZXIgPSAkdXNlcnNNYW5hZ2VyLmdldExvZ2dlZFVzZXIoKTtcbiAgICAgICAgXG4gICAgICAgICRodHRwKHtcbiAgICAgICAgICAgIHVybCA6IF91cmwgKyAnL3Bob3RvcycsXG4gICAgICAgICAgICBkYXRhIDoge1xuICAgICAgICAgICAgICAgIGltYWdlIDogdXJsLFxuICAgICAgICAgICAgICAgIHVzZXJuYW1lIDogX3VzZXIudXNlcm5hbWUsXG4gICAgICAgICAgICAgICAgdXNlcl9pZCA6IF91c2VyLl9pZCxcbiAgICAgICAgICAgICAgICB0aXRsZSA6IHRpdGxlLFxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIG1ldGhvZCA6ICdQT1NUJ1xuICAgICAgICB9KS50aGVuKHVwUGhvdG9PSylcbiAgICAgICAgLmNhdGNoKHVwUGhvdG9Xcm9uZyk7XG4gICAgICAgIFxuICAgICAgICBmdW5jdGlvbiB1cFBob3RvT0socmVzcG9uc2UpIHtcbiAgICAgICAgICAgIF9xdS5yZXNvbHZlKHJlc3BvbnNlLmRhdGEpO1xuICAgICAgICB9O1xuICAgICAgICBcbiAgICAgICAgZnVuY3Rpb24gdXBQaG90b1dyb25nKGVycm9yKSB7XG4gICAgICAgICAgICBfcXUucmVqZWN0KCdFcnJvcicpO1xuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICByZXR1cm4gX3F1LnByb21pc2U7XG4gICAgfTtcbiAgICBcbiAgICBcbn0iLCJpbXBvcnQgc2VydmljZSBmcm9tICcuL3NlcnZpY2UnO1xuXG5hbmd1bGFyXG4gICAgLm1vZHVsZSgndHJhbnN2ZXJzYWwudXNlcnNNYW5hZ2VyJywgW10pXG4gICAgLnNlcnZpY2UoJyR1c2Vyc01hbmFnZXInLCBzZXJ2aWNlKTtcbiIsImV4cG9ydCBkZWZhdWx0IGZ1bmN0aW9uICgpIHtcbiAgICAnbmdJbmplY3QnO1xuICAgIHZhciBfbG9nZ2VkO1xuXG4gICAgdGhpcy5zZXRMb2dnZWRVc2VyID0gZnVuY3Rpb24odXNlcikge1xuICAgICAgICBfbG9nZ2VkID0gdXNlcjtcbiAgICB9O1xuXG4gICAgdGhpcy5nZXRMb2dnZWRVc2VyID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBfbG9nZ2VkO1xuICAgIH07XG5cbiAgICB0aGlzLmxvZ2dvdXQgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgX2xvZ2dlZCA9IG51bGw7XG4gICAgfVxufSJdfQ==
